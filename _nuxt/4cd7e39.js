(window.webpackJsonp=window.webpackJsonp||[]).push([[11,3,5,7],{436:function(t,e,n){var content=n(439);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(22).default)("363f7858",content,!0,{sourceMap:!1})},437:function(t,e,n){var content=n(443);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(22).default)("5905e1af",content,!0,{sourceMap:!1})},438:function(t,e,n){"use strict";n(436)},439:function(t,e,n){var o=n(21)(!1);o.push([t.i,".drawcanvas{position:absolute;top:0;left:0;width:100%;height:100%;touch-action:pinch-zoom}@media screen{.drawcanvas{border:1px dashed silver}}",""]),t.exports=o},440:function(t,e,n){"use strict";n.r(e);var o=n(32),r=(n(4),n(59),n(45),n(111),{props:["points","mode","w","h"],data:function(){return{x:0,y:0,r:1,px:"",color:"#606060",lineWidth:3,c_w:0,c_h:0,currentWidth:0,isOn:!1,isEffective:!1,isMoved:!1,currnetPoint:null,currentLine:null,innerPoints:[],redodata:[],eracedData:[],canvas:null,context:null}},watch:{mode:function(){switch(this.mode){case 0:break;case 1:this.clear(),this.reDraw(),this.$emit("update:mode",0);break;case 2:this.clear(),this.rePlay(),this.$emit("update:mode",0);break;case 3:this.undo(),this.$emit("update:mode",0);break;case 4:this.redo(),this.$emit("update:mode",0);break;case 5:this.$emit("update:points",this.innerPoints),this.$emit("update:mode",0)}},points:function(){0==this.points.length?(this.eracedData=this.innerPoints,this.redodata=[],this.innerPoints=this.points,this.clear()):0==this.mode&&(this.innerPoints=this.points)},w:function(){this.c_w=this.w},h:function(){this.c_h=this.h}},mounted:function(){this.init()},methods:{init:function(){this.canvas=this.$refs.canvas,this.context=this.canvas.getContext("2d"),this.canvas.addEventListener("pointerdown",this.pointerdown,!1),this.canvas.addEventListener("pointerup",this.pointerup,!1),this.canvas.addEventListener("pointermove",this.pointermove,!1)},resize:function(){var t=this;this.currentWidth=window.innerWidth,this.$nextTick((function(){t.r=window.devicePixelRatio,t.c_w=t.canvas.clientWidth,t.c_h=t.canvas.clientHeight,t.$emit("update:w",t.canvas.clientWidth),t.$emit("update:h",t.canvas.clientHeight)}))},resizeEvent:function(){this.resize()},getPoint:function(t){return{x:t.layerX,y:t.layerY}},pointerup:function(t){if(!this.isMoved){var p=this.getPoint(t);this.currentLine.push(p),this.context.lineTo(p.x,p.y),this.context.lineCap="round",this.context.lineWidth=this.lineWidth,this.context.strokeStyle=this.color,this.context.stroke()}this.innerPoints.push(this.currentLine),this.isMoved=!1},pointerdown:function(t){if(t.preventDefault(),0==this.mode){this.redodata=[],this.eracedData=[],t.target.setPointerCapture(t.pointerId);var p=this.getPoint(t);this.currentLine=[],this.currentLine.push(p),this.isMoved=!1,this.context.beginPath(),this.context.moveTo(p.x,p.y)}},pointermove:function(t){if(1==t.buttons||1==t.witch||"touchmove"==t.type){this.isMoved=!0;var p=this.getPoint(t);this.currentLine.push(p),this.context.lineTo(p.x,p.y),this.context.lineCap="round",this.context.lineWidth=this.lineWidth,this.context.strokeStyle=this.color,this.context.stroke()}},drawLine:function(p){this.context.beginPath(),this.context.moveTo(this.currnetPoint.x,this.currnetPoint.y),this.context.lineTo(p.x,p.y),this.context.lineWidth=this.lineWidth,this.context.lineCap="round",this.context.strokeStyle=this.color,this.context.stroke()},reDraw:function(){var t=this;this.$nextTick((function(){for(var i=0;i<t.innerPoints.length;i++){t.currnetPoint=t.innerPoints[i][0];for(var e=0;e<t.innerPoints[i].length;e++)t.drawLine(t.innerPoints[i][e]),t.currnetPoint=t.innerPoints[i][e]}}))},rePlay:function(){var t=this;this.$nextTick(Object(o.a)(regeneratorRuntime.mark((function e(){var i,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=0;case 1:if(!(i<t.innerPoints.length)){e.next=17;break}t.currnetPoint=t.innerPoints[i][0],n=0;case 4:if(!(n<t.innerPoints[i].length)){e.next=12;break}return t.drawLine(t.innerPoints[i][n]),t.currnetPoint=t.innerPoints[i][n],e.next=9,t.sleep(5);case 9:n++,e.next=4;break;case 12:return e.next=14,t.sleep(300);case 14:i++,e.next=1;break;case 17:case"end":return e.stop()}}),e)}))))},clear:function(){this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.context.fillStyle="rgb(255,255,255"},sleep:function(t){return new Promise((function(e){setTimeout((function(){e()}),t)}))},undo:function(){if(this.eracedData.length>0)return this.innerPoints=this.eracedData,this.eracedData=[],this.clear(),void this.reDraw();if(0!=this.innerPoints.length){var t=this.innerPoints.slice(-1);this.redodata.push(t[0]),this.innerPoints=this.innerPoints.slice(0,-1),this.clear(),this.reDraw()}},redo:function(){if(0!=this.redodata.length){var t=this.redodata.slice(-1);this.innerPoints.push(t[0]),this.redodata=this.redodata.slice(0,-1),this.clear(),this.reDraw()}}}}),c=(n(438),n(72)),component=Object(c.a)(r,(function(){var t=this;return(0,t._self._c)("canvas",{ref:"canvas",staticClass:"drawcanvas",attrs:{width:t.c_w,height:t.c_h}})}),[],!1,null,null,null);e.default=component.exports},442:function(t,e,n){"use strict";n(437)},443:function(t,e,n){var o=n(21)(!1);o.push([t.i,".draw-box-wrapper{display:block;position:relative;margin:0}.drawtext{display:block;top:-.5em;bottom:0;right:0;writing-mode:vertical-rl;white-space:nowrap}.drawdebugbox,.drawtext{position:absolute;left:0}.drawdebugbox{font-size:10px}.command-bar,.drawdebugbox{top:0;writing-mode:horizontal-tb}.command-bar{position:absolute!important;right:0;display:flex}@media print{.command-bar{display:none}}.pointerbox{position:absolute;bottom:0;left:0;writing-mode:horizontal-tb;font-size:10px}ruby{word-break:keep-all;color:#c8c8c8}.ruby-hint{color:hsla(0,0%,78.4%,0);transition:color 2s}rt{color:#202020;font-size:.2em}",""]),t.exports=o},459:function(t,e,n){"use strict";n.r(e);var o=n(284),r=n(191),c=(n(59),{props:["word","index","fs","sa","md"],data:function(){return{x:0,y:0,ratio:1,fontSize:64,px:"",isOn:!1,isEffective:!1,points:[],pointNow:null,mode:0,currentWidth:0,c_w:0,c_h:0,drawtext:null,hint:!1,showAnswers:!1,debug:!1}},watch:{word:function(){var t=this;this.$nextTick((function(){t.word.a.length>0&&(t.clear(),t.resize())}))},fs:function(){var t=this;this.fontSize=this.fs,this.$nextTick((function(){t.init(),t.$nextTick((function(){t.resize()}))}))},sa:function(){console.log("drawBox2: showAnswers chenged"),this.showAnswers=this.sa},md:function(){this.mode=this.md},mode:function(){this.$emit("update:md",this.mode)}},computed:{ans:function(){return this.showAnswers?this.word.a:this.word.q}},mounted:function(){var t=this;this.drawtext=this.$refs.drawtext,this.init(),this.$nextTick((function(){t.resize()})),window.addEventListener("orientationchange",this.resizeEvent),window.addEventListener("resize",this.resizeEvent)},methods:{init:function(){this.ratio=window.devicePixelRatio;var t=this.$refs.drawboxwrapper,e=Math.round(this.fontSize*this.ratio);this.px=e+"px",t.style.fontSize=this.px,t.style.padding="28px 0 0 0";var n=Math.round(e+this.fontSize/2*this.ratio);t.style.width="".concat(n,"px"),this.c_w=n},resize:function(){this.currentWidth=window.innerWidth;var t=this.$refs.drawboxwrapper,e=Math.round(this.fontSize*this.ratio),n=Math.round(e*(this.word.a.length+2)-e/3);t.style.height="".concat(n,"px"),this.c_h=n},resizeEvent:function(){console.log("drawBox2: resize event occured"),this.resize()},replay:function(){this.mode=2},clear:function(){this.points=[]},emitChange:function(){var t=this;this.mode=5,this.$nextTick((function(){t.$emit("change",t.points)}))},load:function(){var t=this;this.$axios.get("/data_b.json").then((function(e){t.points=e.data}))},showHint:function(){var t=this;this.hint=!0,setTimeout((function(){t.hint=!1}),1e3)},undo:function(){this.mode=3},redo:function(){this.mode=4}}}),l=(n(442),n(72)),component=Object(l.a)(c,(function(){var t=this,e=t._self._c;return e("div",{ref:"drawboxwrapper",staticClass:"draw-box-wrapper"},[e("div",{ref:"drawtext",staticClass:"drawtext"},[e("span",[t._v("（")]),t._v(" "),e("ruby",{class:{"ruby-hint":!t.hint}},[t._v("\n      "+t._s(t.word.a)+"\n      "),e("rt",[t._v(t._s(t.ans))])]),t._v(" "),e("span",[t._v("）")])]),t._v(" "),t.debug?e("div",{staticClass:"drawdebugbox"},[t._v("\n    "+t._s(t.x)+","+t._s(t.y)+", "+t._s(Math.round(100*t.ratio))+"%, "+t._s(t.px)+", "+t._s(t.c_w)+",\n    "+t._s(t.c_h)+"\n  ")]):t._e(),t._v(" "),t.debug?e("div",{staticClass:"pointerbox"},[t._v(t._s(t.pointNow))]):t._e(),t._v(" "),e("draw-canvas2",{ref:"drawcanvas",attrs:{points:t.points,mode:t.mode,w:t.c_w,h:t.c_h},on:{"update:points":function(e){t.points=e},"update:mode":function(e){t.mode=e},"update:w":function(e){t.c_w=e},"update:h":function(e){t.c_h=e}}}),t._v(" "),e("div",{staticClass:"command-bar"},[t.debug?e("div",[e(o.a,{attrs:{"x-small":t.ratio<2,small:t.ratio>=2,color:"teal",icon:""},on:{click:t.load}},[e(r.a,[t._v("mdi-download")])],1),t._v(" "),e(o.a,{attrs:{"x-small":t.ratio<2,small:t.ratio>=2,color:"teal",icon:""},on:{click:t.emitChange}},[e(r.a,[t._v("mdi-ladybug")])],1),t._v(" "),e(o.a,{attrs:{"x-small":t.ratio<2,small:t.ratio>=2,color:"teal",icon:""},on:{click:t.replay}},[e(r.a,[t._v("mdi-play-circle")])],1)],1):t._e(),t._v(" "),e(o.a,{attrs:{"x-small":t.ratio<2,small:t.ratio>=2,color:"teal",icon:""},on:{click:t.undo}},[e(r.a,[t._v("mdi-undo")])],1),t._v(" "),e(o.a,{attrs:{"x-small":t.ratio<2,small:t.ratio>=2,color:"teal",icon:""},on:{click:t.redo}},[e(r.a,[t._v("mdi-redo")])],1),t._v(" "),e(o.a,{attrs:{"x-small":t.ratio<2,small:t.ratio>=2,color:"teal",icon:""},on:{click:t.showHint}},[e(r.a,[t._v("mdi-help-circle")])],1),t._v(" "),e(o.a,{attrs:{"x-small":t.ratio<2,small:t.ratio>=2,color:"teal",icon:""},on:{click:t.clear}},[e(r.a,[t._v("mdi-delete")])],1)],1)],1)}),[],!1,null,null,null);e.default=component.exports;installComponents(component,{DrawCanvas2:n(440).default})},461:function(t,e,n){var content=n(470);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(22).default)("8db6b294",content,!0,{sourceMap:!1})},463:function(t,e,n){"use strict";n(4),n(9),n(45),n(66),n(36);var o=n(460);e.a={questions:null,parsed_questions:[],csv2obj:function(t){var e=this;return this.parsed_questions=[],this.questions=o.parse(t,{header:!0}).data,this.questions.forEach((function(q){var t=e.analyse(q.answer),n=e.analyse(q.question),o={grade:q.grade,term:q.term,number:q.number,exam:e.create(n,t)};e.parsed_questions.push(o)})),this.parsed_questions},analyse:function(t){var e=[],n="",o=0,r=t.indexOf("(",o);if(-1==r)return e.push({text:t,type:1}),e;for(;-1!=r;){o!=r&&(0==o?(n=t.slice(o,r),e.push({text:n,type:0})):(n=t.slice(o+1,r),e.push({text:n,type:0})));var c=t.indexOf(")",r);if(-1==c)return n=t.slice(r+1),e.push({text:n,type:0}),e;o=c,n=t.slice(r+1,c),e.push({text:n,type:1}),r=t.indexOf("(",o)}return t.length>o&&(n=t.slice(o+1),e.push({text:n,type:0})),e},create:function(t,e){for(var n=[],i=0;i<t.length;i++){var o=e[i]||{text:""};n.push({q:t[i].text,a:o.text,type:t[i].type})}return n},csv2tests:function(t){var e=[],n=o.parse(t,{header:!0}).data;return console.log("csv2tests",JSON.stringify(n)),n.forEach((function(t){console.log("t.numbers",t);var n=[];t.numbers.trim().split(" ").forEach((function(t){n.push(t)}));var o={name:t.name,numbers:n};e.push(o)})),e}}},469:function(t,e,n){"use strict";n(461)},470:function(t,e,n){var o=n(21)(!1);o.push([t.i,".ans-box-wrapper{position:relative;padding:.5em .7em .5em 0;border-bottom:1px solid silver;display:flex;flex-direction:column;justify-content:flex-start;align-items:center}.wordbox{display:block;writing-mode:vertical-rl}",""]),t.exports=o},477:function(t,e,n){var content=n(522);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(22).default)("3db79ae0",content,!0,{sourceMap:!1})},481:function(t,e,n){"use strict";n.r(e);n(35);var o={props:["q","index","fs","sa"],data:function(){return{question:[],answer:[],html:"",handwriter:null,canvas:null,ansbox:null,x:0,y:0,fontSize:64,mode:0,debug:!1}},watch:{"q.answer":function(){this.answer=this.analyse(this.q.answer),console.log("a:",JSON.stringify(this.answer))},"q.question":function(){this.question=this.analyse(this.q.question),console.log("q:",JSON.stringify(this.question))},fs:function(){this.fontSize=this.fs}},created:function(){},mounted:function(){this.fontSize=this.fs},methods:{debugPrint:function(){var t=this.canvas.width,e=this.canvas.height,n=(this.ansbox.clientX,this.ansbox.clientY,this.ansbox.clientWidth),o=this.ansbox.clientHeight;console.log("canvas: w:".concat(t,", h:").concat(e)),console.log("ansbox: w:".concat(n,", h:").concat(o)),console.log("q: ".concat(JSON.stringify(this.q)))},create:function(){for(var t="",i=0;i<this.q.length;i++){var e=this.q[i].a;0==this.q[i].type?t+='<span class="text">'+e+"</span>":1==this.q[i].type&&(t+="（<ruby>"+e+"<rt>"+this.q[i].q+"</rt></ruby>）")}return t}}},r=(n(469),n(72)),component=Object(r.a)(o,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"ans-box-wrapper"},t._l(t.q,(function(n,o){return e("div",{key:o},[0==n.type?e("div",{staticClass:"wordbox",style:{"font-size":t.fs/2+"px"}},[t._v("\n      "+t._s(n.q)+"\n    ")]):t._e(),t._v(" "),t.debug?e("div",{staticClass:"debugbox"},[t._v(t._s(t.x)+","+t._s(t.y))]):t._e(),t._v(" "),1==n.type?e("draw-box2",{attrs:{word:n,index:o,fs:t.fontSize,sa:t.sa}}):t._e()],1)})),0)}),[],!1,null,null,null);e.default=component.exports;installComponents(component,{DrawBox2:n(459).default})},521:function(t,e,n){"use strict";n(477)},522:function(t,e,n){var o=n(21)(!1);o.push([t.i,'.kanji-test{font:14px/1.7 "Lucida Grande","Hiragino Kaku Gothic ProN","ヒラギノ角ゴ ProN W3","游ゴシック","Yu Gothic",sans-serif;width:100%;height:97vh;color:#202020;display:flex;align-items:flex-start;align-content:flex-end}@media(orientation:landscape){.kanji-test{margin:1em 0;padding:1em;flex-direction:row-reverse;float:right}.kanji-test h1,.kanji-test h3{writing-mode:vertical-rl;text-orientation:mixed}}@media(orientation:portrait){.kanji-test{margin:0;padding:0;flex-direction:column}.kanji-test h1,.kanji-test h3{writing-mode:horizontal-tb}}.group{writing-mode:horizontal-tb;text-orientation:mixed;display:flex;flex-direction:row-reverse;flex-wrap:wrap;align-content:flex-start;width:85vw}@media(-webkit-min-device-pixel-ratio:1),(min-resolution:1dppx){.group{font-size:14px}}@media(-webkit-min-device-pixel-ratio:2),(min-resolution:2dppx){.group{font-size:28px}}@media(-webkit-min-device-pixel-ratio:3),(min-resolution:3dppx){.group{font-size:32 qpx}}.ansbox{font-size:3em;line-height:1.2;position:relative}.ans-box-wrapper-last{position:relative;padding:.5em .7em .5em 0;border-bottom:1px solid silver;flex-grow:1}.combine{text-combine-upright:all;-webkit-text-combine:horizontal}.line{text-decoration:underline;text-underline-position:right;-webkit-text-decoration-style:wavy;text-decoration-style:wavy}',""]),t.exports=o},535:function(t,e,n){"use strict";n.r(e);var o=n(284),r=n(473),c=n(458),l=n(191),h=n(189),d=n(129),f=n(190),v=n(85),x=n(480),m=n(532),w=n(531),_=n(429),y=n(539),k=(n(11),n(61),n(32)),P=(n(111),n(36),n(45),n(10),n(4),n(29),n(134),n(9),n(463)),z=n(460),S={layout:"pyper",data:function(){return{subject:"マンデーテスト",description:"さあ、君は全問正解出るか！",questions:[],deviceWidth:0,deviceHeight:0,devicePixelRatio:0,fontSize:41,parsed_questions:null,tests:null,selectedTest:null,menu:!1,showAnswers:!1,points_debug:"",debug:!1}},watch:{menu:function(){0==this.menu&&this.save()},selectedTest:function(){this.subject=this.selectedTest.name,this.showAnswers=!1}},computed:{testdata:function(){return null!=this.parsed_questions?this.parsed_questions[3].exam[0]:[]},q_pages:function(){for(var t=[],e=Math.floor(this.q_cols.length/2),i=0;i<e;i++)t.push(this.q_cols.slice(2*i,2*(i+1)));return t},q_cols:function(){for(var t=this.questions.length,e=Math.floor(t/8),n=[],i=0;i<=e;i++)n.push(this.questions.slice(8*i,8*(i+1)));return n},selectedQuestions:function(){var t=this;return this.parsed_questions&&this.selectedTest?this.parsed_questions.filter((function(q){return t.selectedTest.numbers.indexOf(q.number)>=0})):[]},selectedSubject:function(){var t="";this.selectedTest&&(this.selectedTest.name.match(/[0-9]+|\D+/gi).forEach((function(e){/[0-9]/gi.test(e)?(console.log("number",e),t+='<span class="combine">'+e+"</span>"):(console.log("string",e),t+=e)})),console.log("selectedSubject:",this.selectedTest.name,t));return t}},mounted:function(){var t=this;return Object(k.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"/tegaki-exam",e.next=3,t.$axios.get("".concat("/tegaki-exam","/questions.csv"));case 3:return n=e.sent,t.questions=z.parse(n.data,{header:!0}).data,t.parsed_questions=P.a.csv2obj(n.data),console.log("parsed_questions: ".concat(JSON.stringify(t.parsed_questions))),e.next=9,t.$axios.get("/tests.csv");case 9:n=e.sent,console.log("tests row",n.data),t.tests=P.a.csv2tests(n.data),console.log("tests",JSON.stringify(t.tests)),t.deviceWidth=screen.width,t.deviceHeight=screen.height,t.devicePixelRatio=window.devicePixelRatio,t.load(),console.log("testdata",t.testdata);case 18:case"end":return e.stop()}}),e)})))()},methods:{drawBoxChange:function(t){console.log("drawBoxChange",t),this.points_debug=JSON.stringify(t)},save:function(){localStorage.setItem("kanji_test_config",this.fontSize)},load:function(){this.fontSize=localStorage.getItem("kanji_test_config")||this.fontSize}}},T=(n(521),n(72)),component=Object(T.a)(S,(function(){var t=this,e=t._self._c;return e("div",[e(x.a,{attrs:{"close-on-content-click":!1,"nudge-width":200,"offset-x":""},scopedSlots:t._u([{key:"activator",fn:function(n){var r=n.on,c=n.attrs;return[e(o.a,t._g(t._b({staticStyle:{position:"absolute",top:"5px",left:"5px"},attrs:{color:"teal",dark:"",fab:"",small:""}},"v-btn",c,!1),r),[e(l.a,[t._v("mdi-cog")])],1)]}}]),model:{value:t.menu,callback:function(e){t.menu=e},expression:"menu"}},[t._v(" "),e(r.a,[e(h.a,[e(d.a,[e("div",{staticStyle:{"margin-top":"2em",width:"100%"}},[e(w.a,{attrs:{"thumb-label":"",min:"32",max:"96"},model:{value:t.fontSize,callback:function(e){t.fontSize=e},expression:"fontSize"}})],1),t._v(" "),e("div",{staticStyle:{"white-space":"nowrap"}},[t._v("大きさ")])]),t._v(" "),e(d.a,[e(m.a,{attrs:{items:t.tests,label:"テスト","item-text":"name","item-value":"numbers","return-object":!0},model:{value:t.selectedTest,callback:function(e){t.selectedTest=e},expression:"selectedTest"}})],1),t._v(" "),e(d.a,[e(f.a,[e(y.a,{model:{value:t.showAnswers,callback:function(e){t.showAnswers=e},expression:"showAnswers"}})],1),t._v(" "),e(v.b,[t._v("答え合わせ")])],1)],1),t._v(" "),e(c.a,[e(_.a),t._v(" "),e(o.a,{attrs:{text:""},on:{click:function(e){t.menu=!1}}},[t._v("OK")])],1)],1)],1),t._v(" "),e("div",{staticClass:"kanji-test"},[e("h1",{domProps:{innerHTML:t._s(t.selectedSubject)}}),t._v(" "),e("h3",[t._v(t._s(t.description))]),t._v(" "),e("div",{staticClass:"group"},[t._l(t.selectedQuestions,(function(q,n){return e("ans-box",{key:n,attrs:{q:q.exam,index:n,fs:t.fontSize,sa:t.showAnswers}})})),t._v(" "),e("div",{staticClass:"ans-box-wrapper-last"})],2)]),t._v(" "),t.debug?e("div",[t._v("\n    "+t._s(t.deviceWidth)+" "+t._s(t.deviceHeight)+" "+t._s(t.devicePixelRatio)+"\n  ")]):t._e()],1)}),[],!1,null,null,null);e.default=component.exports;installComponents(component,{AnsBox:n(481).default})}}]);